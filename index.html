<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expense Tracker</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        /* Basic Resets & Global Styles */
        
        body {
            font-family: 'Roboto', sans-serif;
            /* Use Roboto or Arial if not loaded */
            background-color: #f0f2f5;
            /* Light grey background */
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            color: #333;
        }
        
        .container {
            background-color: #ffffff;
            /* White card background */
            padding: 25px;
            border-radius: 10px;
            /* Slightly rounded corners */
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            /* Soft shadow */
            max-width: 400px;
            width: 100%;
        }
        
        h2,
        h3 {
            text-align: center;
            margin-bottom: 20px;
            color: #5a20cb;
            /* A nice shade of purple/blue */
        }
        /* Balance & Summary */
        
        .balance-summary {
            background-color: #e9eef6;
            /* Lighter background for summary */
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 25px;
            text-align: center;
        }
        
        .balance-summary #balance {
            font-size: 2.2em;
            font-weight: 700;
            color: #2c3e50;
            /* Darker text for balance */
            display: block;
            margin-top: 5px;
        }
        
        .inc-exp-display {
            display: flex;
            justify-content: space-around;
            padding: 15px 0;
            border-top: 1px solid #eee;
            margin-top: 15px;
        }
        
        .inc-exp-display>div {
            flex: 1;
            text-align: center;
        }
        
        .inc-exp-display>div:first-child {
            border-right: 1px solid #eee;
        }
        
        .inc-exp-display h4 {
            margin-bottom: 5px;
            color: #666;
        }
        
        .money {
            font-size: 1.3em;
            font-weight: 700;
        }
        
        .money.income {
            color: #28a745;
            /* Green for income */
        }
        
        .money.expense {
            color: #dc3545;
            /* Red for expense */
        }
        /* Form Styles */
        
        form {
            display: flex;
            flex-direction: column;
            margin-bottom: 25px;
        }
        
        form label {
            margin-bottom: 8px;
            font-weight: 500;
            color: #555;
        }
        
        form input[type="text"],
        form input[type="number"],
        form select {
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 10px;
            font-size: 1em;
            margin-bottom: 15px;
            width: 100%;
            /* Ensure full width */
            box-sizing: border-box;
            /* Include padding/border in width */
        }
        
        form input:focus,
        form select:focus {
            outline: none;
            border-color: #5a20cb;
            box-shadow: 0 0 0 2px rgba(90, 32, 203, 0.2);
        }
        
        form button[type="submit"] {
            background-color: #5a20cb;
            color: white;
            border: none;
            padding: 12px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            transition: background-color 0.2s ease;
        }
        
        form button[type="submit"]:hover {
            background-color: #7c4dff;
            /* Lighter on hover */
        }
        /* Transaction List */
        
        .transactions-section h3 {
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
            margin-bottom: 15px;
        }
        
        #list {
            list-style: none;
            padding: 0;
        }
        
        #list li {
            background-color: #fdfdfd;
            border-left: 5px solid;
            /* For income/expense indicator */
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 15px;
            margin-bottom: 10px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.08);
            position: relative;
            font-size: 0.95em;
        }
        
        #list li.income {
            border-color: #28a745;
        }
        
        #list li.expense {
            border-color: #dc3545;
        }
        
        #list li .transaction-details {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            flex-grow: 1;
        }
        
        #list li .transaction-amount {
            font-weight: 600;
            margin-left: 10px;
            flex-shrink: 0;
        }
        
        #list li .delete-btn {
            background-color: #e74c3c;
            color: white;
            border: none;
            cursor: pointer;
            font-size: 0.9em;
            padding: 4px 8px;
            border-radius: 3px;
            margin-left: 10px;
            opacity: 0;
            transition: opacity 0.2s ease;
        }
        
        #list li:hover .delete-btn {
            opacity: 1;
        }
        /* Category Management */
        
        .category-section {
            border-top: 1px dashed #ddd;
            padding-top: 25px;
            margin-top: 25px;
        }
        
        .category-section h3 {
            margin-bottom: 15px;
        }
        
        .category-input-group {
            display: flex;
            margin-bottom: 15px;
        }
        
        .category-input-group input {
            flex-grow: 1;
            margin-right: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 10px;
            font-size: 1em;
        }
        
        .category-input-group button {
            background-color: #28a745;
            /* Green for add category */
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.2s ease;
        }
        
        .category-input-group button:hover {
            background-color: #218838;
        }
        
        #category-list {
            list-style: disc;
            /* Use discs for category list */
            padding-left: 25px;
            color: #555;
        }
        
        #category-list li {
            background: none;
            /* No special background for category list items */
            box-shadow: none;
            border: none;
            margin-bottom: 5px;
            padding: 3px 0;
            font-size: 0.9em;
        }
    </style>
</head>

<body>
    <div class="container">
        <h2>Expense Tracker</h2>

        <div class="balance-summary">
            <h3>Your Balance</h3>
            <span id="balance">$0.00</span>
            <div class="inc-exp-display">
                <div>
                    <h4>Income</h4>
                    <p id="money-plus" class="money income">$0.00</p>
                </div>
                <div>
                    <h4>Expense</h4>
                    <p id="money-minus" class="money expense">$0.00</p>
                </div>
            </div>
        </div>

        <h3>Add New Transaction</h3>
        <form id="form">
            <label for="text">Description</label>
            <input type="text" id="text" placeholder="Enter transaction description" required />

            <label for="amount">Amount (negative: expense, positive: income)</label>
            <input type="number" id="amount" placeholder="Enter amount" required />

            <label for="category-select">Category</label>
            <select id="category-select" required>
                </select>

            <button type="submit">Add Transaction</button>
        </form>

        <div class="transactions-section">
            <h3>History</h3>
            <ul id="list">
            </ul>
        </div>

        <div class="category-section">
            <h3>Manage Categories</h3>
            <div class="category-input-group">
                <input type="text" id="category-input" placeholder="Add new category" />
                <button onclick="addCategory()">Add</button>
            </div>
            <ul id="category-list">
            </ul>
        </div>
    </div>

    <script>
        const balance = document.getElementById('balance');
        const money_plus = document.getElementById('money-plus');
        const money_minus = document.getElementById('money-minus');
        const list = document.getElementById('list');
        const form = document.getElementById('form');
        const text = document.getElementById('text');
        const amount = document.getElementById('amount');
        const categorySelect = document.getElementById('category-select');
        const categoryInput = document.getElementById('category-input');

        let transactions = JSON.parse(localStorage.getItem('transactions')) || [];
        let categories = JSON.parse(localStorage.getItem('categories')) || ['Food', 'Transport', 'Utilities', 'Salary', 'Entertainment']; // Default categories

        // Generate random ID
        function generateID() {
            return Math.floor(Math.random() * 100000000);
        }

        function addTransaction(e) {
            e.preventDefault();

            if (text.value.trim() === '' || amount.value.trim() === '' || categorySelect.value.trim() === '') {
                alert('Please add a description, amount, and select a category.');
                return;
            }

            const transaction = {
                id: generateID(),
                text: text.value,
                amount: +amount.value,
                category: categorySelect.value
            };

            transactions.push(transaction);
            updateLocalStorage();
            addTransactionDOM(transaction);
            updateValues();

            text.value = '';
            amount.value = '';
            // Don't clear categorySelect.value so user can add multiple transactions of same category
        }

        function addTransactionDOM(transaction) {
            const sign = transaction.amount < 0 ? '-' : '+';
            const item = document.createElement('li');

            item.classList.add(transaction.amount < 0 ? 'expense' : 'income');

            item.innerHTML = `
                <div class="transaction-details">
                    ${transaction.text} <br>
                    <small>(${transaction.category})</small>
                </div>
                <span class="transaction-amount">${sign}$${Math.abs(transaction.amount).toFixed(2)}</span>
                <button class="delete-btn" onclick="removeTransaction(${transaction.id})">x</button>
            `;

            list.appendChild(item);
        }

        function updateValues() {
            const amounts = transactions.map(t => t.amount);
            const income = amounts.filter(a => a > 0).reduce((acc, item) => acc + item, 0).toFixed(2);
            const expense = (amounts.filter(a => a < 0).reduce((acc, item) => acc + item, 0) * -1).toFixed(2);
            const total = (amounts.reduce((acc, item) => acc + item, 0)).toFixed(2);

            balance.innerText = `$${total}`;
            money_plus.innerText = `$${income}`;
            money_minus.innerText = `$${expense}`;
        }

        function removeTransaction(id) {
            transactions = transactions.filter(t => t.id !== id);
            updateLocalStorage();
            init(); // Re-initialize to update the UI
        }

        function updateLocalStorage() {
            localStorage.setItem('transactions', JSON.stringify(transactions));
            localStorage.setItem('categories', JSON.stringify(categories));
        }

        function init() {
            list.innerHTML = '';
            transactions.forEach(addTransactionDOM);
            updateValues();
            renderCategories();
            populateCategoryDropdown();
        }

        // Category Functions
        function addCategory() {
            const name = categoryInput.value.trim();
            if (!name) {
                alert('Please enter a category name.');
                return;
            }
            if (categories.includes(name)) {
                alert('This category already exists!');
                categoryInput.value = '';
                return;
            }
            categories.push(name);
            categoryInput.value = '';
            updateLocalStorage();
            renderCategories();
            populateCategoryDropdown();
        }

        function renderCategories() {
            const categoryListElement = document.getElementById('category-list');
            categoryListElement.innerHTML = '';
            categories.forEach(cat => {
                const li = document.createElement('li');
                li.textContent = cat;
                categoryListElement.appendChild(li);
            });
        }

        function populateCategoryDropdown() {
            categorySelect.innerHTML = '<option value="">Select Category</option>';
            categories.forEach(cat => {
                const opt = document.createElement('option');
                opt.value = cat;
                opt.textContent = cat;
                categorySelect.appendChild(opt);
            });
        }

        // Event Listener
        form.addEventListener('submit', addTransaction);

        // Initialize App
        init();
    </script>
</body>

</html>